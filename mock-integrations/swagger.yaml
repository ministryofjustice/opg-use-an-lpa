components:
  schemas:
    Address:
      properties:
        addressLine1:
          description: The first line of the address
          maxLength: 255
          type: string
        addressLine2:
          description: The second line of the address
          maxLength: 255
          type: string
        addressLine3:
          description: The third line of the address
          maxLength: 255
          type: string
        country:
          description: Address country
          example: UK
          maxLength: 255
          type: string
        county:
          description: The county
          maxLength: 255
          type: string
        id:
          description: The address database ID
          type: integer
        postcode:
          description: The postcode
          maxLength: 255
          type: string
        town:
          description: The town
          maxLength: 255
          type: string
        type:
          description: Address type
          example: Primary
          type: string
      required:
      - id
      - town
      - county
      - postcode
      - country
      - type
      - addressLine1
      - addressLine2
      - addressLine3
    CaseActor:
      properties:
        addresses:
          items:
            $ref: '#/components/schemas/Address'
          type: array
        companyName:
          description: The case actor's company name (if relevant)
          example: ABC Ltd
          maxLength: 255
          type: string
        dob:
          description: The case actor's date of birth
          example: '1980-10-10'
          type: string
        email:
          description: The case actor's contact email address
          maxLength: 255
          type: string
        firstname:
          description: The case actor's first name
          example: Ian
          maxLength: 255
          type: string
        id:
          description: The case actor's database ID
          type: integer
        middlenames:
          description: The case actor's last name
          example: Deputy
          maxLength: 255
          type: string
        salutation:
          description: The case actor's salutation
          example: Mrs
          type: string
        surname:
          description: The case actor's last name
          example: Deputy
          maxLength: 255
          type: string
        systemStatus:
          description: The active/inactive status of the case actor
          type: boolean
        uId:
          description: The case actor's unique ID (e.g. 7000-0000-0054)
          example: 7000-0000-0054
          type: string
      required:
      - id
      - uId
      - email
      - dob
      - salutation
      - firstname
      - middlenames
      - surname
      - addresses
      type: object
    Donor:
      allOf:
      - $ref: '#/components/schemas/CaseActor'
      - properties:
          linked:
            items:
              properties:
                id:
                  description: The donor's database ID
                  type: integer
                uId:
                  description: The donor's unique ID (e.g. 7000-0000-0054)
                  example: 7000-0000-0054
                  type: string
              required:
              - id
              - uId
              type: object
            type: array
        required:
        - linked
        type: object
    Error400:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-INVALIDREQUEST
                type: string
              detail:
                example: Invalid request, the data is incorrect
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: Invalid Request
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Error401:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-UNAUTHORISED
                type: string
              detail:
                example: Unauthorised (no current user and there should be)
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: User is not authorised
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Error403:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-FORBIDDEN
                type: string
              detail:
                example: Forbidden - The current user is forbidden from accessing
                  this data (in this way)
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: Access Denied
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Error404:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-NOTFOUND
                type: string
              detail:
                example: That URL is not a valid route, or the item resource does
                  not exist
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: Page not found
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Error413:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-FILESIZELIMIT
                type: string
              detail:
                example: Payload too large, try and upload in smaller chunks
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: Payload too large
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Error415:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-MEDIA
                type: string
              detail:
                example: Unsupported media type for this endpoint
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: Unsupported media type
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Error500:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-SERVERERROR
                type: string
              detail:
                example: Something unexpected happened internally
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: Internal server error
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Error503:
      properties:
        errors:
          items:
            properties:
              code:
                example: OPGDATA-API-UNAVAILABLE
                type: string
              detail:
                example: Service is currently unavailable. Please try again later
                type: string
              id:
                example: A123BCD
                type: string
              meta:
                properties:
                  x-ray:
                    example: 93c330d4-7d84-4c1b-8fdb-54cec5bfe747
                    type: string
                type: object
              title:
                example: Service Unavailable
                type: string
            required:
            - code
            - title
            type: object
          type: array
      required:
      - errors
      type: object
    Healthcheck:
      properties:
        api-status:
          example: OK
          type: string
        cache-status:
          example: OK
          type: string
        sirius-status:
          example: OK
          type: string
      type: object
    LetterRequest:
      properties:
        actor_uid:
          type: integer
        case_uid:
          type: integer
      required:
      - case_uid
      - actor_uid
      type: object
    LetterRequestWithCleanse:
      properties:
        case_uid:
          type: integer
        notes:
          maxLength: 1000
          type: string
      required:
      - case_uid
      - notes
      type: object
    Lpa:
      properties:
        applicationHasGuidance:
          type: boolean
        applicationHasRestrictions:
          type: boolean
        applicationType:
          type: string
        attorneyActDecisions:
          type: string
        attorneys:
          items:
            $ref: '#/components/schemas/CaseActor'
          type: array
        cancellationDate:
          description: The date the LPA was cancelled
          example: '2018-06-30'
          type: string
        caseAttorneyJointly:
          type: boolean
        caseAttorneyJointlyAndJointlyAndSeverally:
          type: boolean
        caseAttorneyJointlyAndSeverally:
          type: boolean
        caseAttorneySingular:
          type: boolean
        caseSubtype:
          type: string
        certificateProviders:
          items:
            $ref: '#/components/schemas/CaseActor'
          type: array
        dispatchDate:
          description: The date the LPA was dispatched
          example: '2018-06-30'
          type: string
        donor:
          $ref: '#/components/schemas/Donor'
        id:
          type: integer
        invalidDate:
          description: The date the LPA was marked invalid
          example: '2018-06-30'
          type: string
        lifeSustainingTreatment:
          type: string
        lpaDonorSignatureDate:
          example: '2018-06-30'
          type: string
        lpaIsCleansed:
          type: boolean
        onlineLpaId:
          example: ABC123
          type: string
        receiptDate:
          description: The date the LPA was created
          example: '2018-06-30'
          type: string
        registrationDate:
          description: The date the LPA was registered
          example: '2018-06-30'
          type: string
        rejectedDate:
          description: The date the LPA was rejected
          example: '2018-06-30'
          type: string
        replacementAttorneys:
          items:
            $ref: '#/components/schemas/CaseActor'
          type: array
        status:
          type: string
        trustCorporations:
          items:
            $ref: '#/components/schemas/CaseActor'
          type: array
        uId:
          description: e.g. 7000-0000-0054
          example: 7000-0000-0054
          type: string
        withdrawnDate:
          description: The date the LPA was withdrawn
          example: '2018-06-30'
          type: string
      required:
      - id
      - uId
      - applicationType
      - caseSubtype
      - receiptDate
      - rejectedDate
      - registrationDate
      - cancellationDate
      - invalidDate
      - withdrawnDate
      - dispatchDate
      - status
      - caseAttorneySingular
      - caseAttorneyJointlyAndSeverally
      - caseAttorneyJointly
      - caseAttorneyJointlyAndJointlyAndSeverally
      - applicationHasRestrictions
      - applicationHasGuidance
      - lpaDonorSignatureDate
      - lpaIsCleansed
      - lifeSustainingTreatment
      - onlineLpaId
      - attorneyActDecisions
      - donor
      - attorneys
      - replacementAttorneys
      - certificateProviders
      - trustCorporations
      type: object
    LpaCollection:
      items:
        $ref: '#/components/schemas/Lpa'
      minItems: 0
      type: array
  securitySchemes:
    sigv4:
      in: header
      name: Authorization
      type: apiKey
      x-amazon-apigateway-authtype: awsSigv4
info:
  description: Rest API for LPA Data - ${environment}
  title: lpa-${environment}
  version: '1.0'
openapi: 3.0.2
paths:
  /healthcheck:
    description: opg-data-lpa healthcheck
    get:
      description: Check if required services are available
      operationId: app.healthcheck
      responses:
        200:
          content:
            application/json:
              schema:
                properties:
                  data:
                    $ref: '#/components/schemas/Healthcheck'
                  meta:
                    type: object
                type: object
          description: opg-data-lpa healthcheck
        400:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error400'
          description: Generic bad request (generally invalid syntax)
        401:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error401'
          description: Unauthorised (no current user and there should be)
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error403'
          description: Forbidden - The current user is forbidden from accessing this
            data (in this way)
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error404'
          description: That URL is not a valid route, or the item resource does not
            exist
        500:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error500'
          description: Something unexpected happened and it is the API"s fault
        503:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error503'
          description: Service Unavailable - please try again later
      security:
      - sigv4: []
      summary: opg-data-lpa healthcheck
      tags:
      - opg-data-lpa
      x-amazon-apigateway-integration:
        contentHandling: CONVERT_TO_TEXT
        httpMethod: POST
        passthroughBehavior: when_no_match
        responses:
          default:
            statusCode: '200'
        type: aws_proxy
        uri: arn:aws:apigateway:${region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${region}:${account_id}:function:$${stageVariables.flask_app_name}/invocations
      x-amazon-apigateway-request-validator: all
  /lpa-online-tool/lpas/{lpa_online_tool_id}:
    get:
      parameters:
      - description: Online Tool ID
        example: A12345678987
        in: path
        name: lpa_online_tool_id
        required: true
        schema:
          pattern: ^A\d{11}$
          type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  cancellationDate:
                    description: The date the LPA was registered
                    example: '2018-06-30'
                    format: date
                    nullable: true
                    type: string
                  dispatchDate:
                    description: The date the LPA was dispatched
                    example: '2018-06-30'
                    format: date
                    nullable: true
                    type: string
                  invalidDate:
                    description: The date the LPA was registered
                    example: '2018-06-30'
                    format: date
                    nullable: true
                    type: string
                  onlineLpaId:
                    example: A22486562341
                    pattern: ^A\d{11}$
                    type: string
                  receiptDate:
                    description: The date the LPA was created
                    example: '2018-06-30'
                    format: date
                    type: string
                  registrationDate:
                    description: The date the LPA was registered
                    example: '2018-06-30'
                    format: date
                    nullable: true
                    type: string
                  rejectedDate:
                    description: The date the LPA was rejected
                    example: '2018-06-30'
                    format: date
                    nullable: true
                    type: string
                  status:
                    enum:
                    - Cancelled
                    - Imperfect
                    - Invalid
                    - Pending
                    - Perfect
                    - Rejected
                    - Revoked
                    - Withdrawn
                    - Registered
                    - Payment Pending
                    - Return - unpaid
                    type: string
                  statusDate:
                    description: The date the LPA's status was last changed
                    example: '2018-06-30'
                    format: date
                    nullable: true
                    type: string
                  withdrawnDate:
                    description: The date the LPA was withdrawn
                    example: '2018-06-30'
                    format: date
                    nullable: true
                    type: string
                required:
                - cancellationDate
                - invalidDate
                - onlineLpaId
                - receiptDate
                - registrationDate
                - rejectedDate
                - status
                - statusDate
                - withdrawnDate
                - dispatchDate
                type: object
          description: LPA details returned for the requested ID
          headers:
            Age:
              description: 'The time elapsed, measured in seconds, since the returned
                response body was retrieved from Sirius.

                Under normal circumstances this will be zero (0), indicating the response
                represents the current ''live'' state within Sirius.

                In the case that the Gateway was unable to retrieve an up to date
                response from Sirius, it will make best efforts to return a cached
                version.

                It''s up to the consumer of the API to determine if they wish to use
                a response based on its age.

                '
              schema:
                type: integer
        '400':
          description: Bad request
        '403':
          description: Authentication failed
        '404':
          description: An LPA with the passed ID Not Found
        '429':
          description: API Gateway throttling limit exceeded
        '500':
          description: Unhandeled internal exception within OPG Gateway
        '502':
          description: The Sirius data provider returned an exception
        '504':
          description: The Sirius data provider timed out
      security:
      - sigv4: []
      x-amazon-apigateway-integration:
        contentHandling: CONVERT_TO_TEXT
        httpMethod: POST
        passthroughBehavior: when_no_match
        responses:
          default:
            statusCode: '200'
        type: aws_proxy
        uri: arn:aws:apigateway:${region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${region}:${account_id}:function:$${stageVariables.flask_app_name}/invocations
      x-amazon-apigateway-request-validator: all
  /use-an-lpa/lpas/requestCode:
    post:
      requestBody:
        content:
          application/json:
            examples:
              cleanse:
                summary: as cleanse request
                value:
                  case_uid: 700000000000
                  notes: 'Name: Example

                    Postcode: EX4 MPL

                    Email: example@example.org'
              request:
                summary: as letter request
                value:
                  actor_uid: 700000000000
                  case_uid: 700000000000
            schema:
              oneOf:
              - $ref: '#/components/schemas/LetterRequest'
              - $ref: '#/components/schemas/LetterRequestWithCleanse'
        required: true
      responses:
        '200':
          description: Letter was successfully enqueued or cleanse process started
          schema:
            properties:
              queuedForCleansing:
                description: Whether the request was queued for cleansing
                type: boolean
            required:
            - queuedForCleansing
            type: object
        '204':
          description: Letter was successfully enqueued
        '400':
          description: Invalid request
        '500':
          description: Unexpected error
      security:
      - sigv4: []
      tags:
      - use-a-lpa
      x-amazon-apigateway-integration:
        contentHandling: CONVERT_TO_TEXT
        httpMethod: POST
        passthroughBehavior: when_no_match
        responses:
          default:
            statusCode: '204'
        type: aws_proxy
        uri: arn:aws:apigateway:${region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${region}:${account_id}:function:$${stageVariables.flask_app_name}/invocations
      x-amazon-apigateway-request-validator: all
  /use-an-lpa/lpas/{uid}:
    get:
      parameters:
      - description: Reference Number representing either an LPA Uid or a Meris Id
        examples:
          lpauid: 700000000054
          meris: 3000000
        in: path
        name: uid
        required: true
        schema:
          pattern: (^7\d{11}$|^(2|3)\d{6}$)
          type: string
      responses:
        '200':
          content:
            application/json:
              examples:
                lpa0000:
                  value:
                  - applicationHasGuidance: false
                    applicationHasRestrictions: false
                    applicationType: Classic
                    attorneyActDecisions: ''
                    attorneys:
                    - addresses:
                      - addressLine1: 9 High Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 9
                        postcode: B89 7JK
                        town: Leafland
                        type: Primary
                      companyName: null
                      dob: '1990-05-04'
                      email: ''
                      firstname: Jean
                      id: 9
                      middlenames: ''
                      salutation: ''
                      surname: Sanderson
                      systemStatus: true
                      uId: 7000-0000-0815
                    - addresses:
                      - addressLine1: 7 The Low Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 12
                        postcode: WR1 1EK
                        town: Worcester
                        type: Primary
                      companyName: ''
                      dob: '1975-10-05'
                      email: XXXXX
                      firstname: Annette
                      id: 12
                      middlenames: ''
                      salutation: Mrs
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0000-0849
                    - addresses:
                      - addressLine1: Home
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 3174
                        postcode: N4 4DL
                        town: Home
                        type: Primary
                      companyName: ''
                      dob: '2000-12-15'
                      email: ''
                      firstname: Jess
                      id: 3453
                      middlenames: ''
                      salutation: ''
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0015-0610
                    cancellationDate: ''
                    caseAttorneyJointly: false
                    caseAttorneyJointlyAndJointlyAndSeverally: true
                    caseAttorneyJointlyAndSeverally: false
                    caseAttorneySingular: false
                    caseSubtype: hw
                    certificateProviders:
                    - addresses:
                      - addressLine1: 50 Fordham Rd
                        addressLine2: HADFIELD
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 11
                        postcode: SK14 0RH
                        town: ''
                        type: Primary
                      dob: ''
                      email: ''
                      firstname: Danielle
                      id: 11
                      middlenames: ''
                      salutation: Miss
                      surname: Hart
                      uId: 7000-0000-0831
                    dispatchDate: '2021-04-26'
                    donor:
                      addresses:
                      - addressLine1: 81 Front Street
                        addressLine2: LACEBY
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 7
                        postcode: DN37 5SH
                        town: ''
                        type: Primary
                      companyName: ''
                      dob: '1948-11-01'
                      email: RachelSanderson@opgtest.com
                      firstname: Rachel
                      id: 7
                      linked:
                      - id: 7
                        uId: 7000-0000-0799
                      middlenames: Emma
                      salutation: Mr
                      surname: Sanderson
                      uId: 7000-0000-0799
                    id: 2
                    invalidDate: ''
                    lifeSustainingTreatment: Option A
                    lpaDonorSignatureDate: '2018-12-12'
                    lpaIsCleansed: false
                    onlineLpaId: A33718377316
                    receiptDate: '2014-09-26'
                    registrationDate: '2021-04-26'
                    rejectedDate: ''
                    replacementAttorneys: []
                    status: Registered
                    statusDate: ''
                    trustCorporations: []
                    uId: 7000-0000-0000
                    withdrawnDate: ''
                lpa0047:
                  value:
                  - applicationHasGuidance: false
                    applicationHasRestrictions: false
                    applicationType: Classic
                    attorneyActDecisions: ''
                    attorneys:
                    - addresses:
                      - addressLine1: 9 High Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 9
                        postcode: B89 7JK
                        town: Leafland
                        type: Primary
                      companyName: ''
                      dob: '1990-05-04'
                      email: ''
                      firstname: Jean
                      id: 9
                      middlenames: ''
                      salutation: ''
                      surname: Sanderson
                      systemStatus: true
                      uId: 7000-0000-0815
                    - addresses:
                      - addressLine1: 7 The Low Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 12
                        postcode: WR1 1EK
                        town: Worcester
                        type: Primary
                      companyName: ''
                      dob: '1975-10-05'
                      email: XXXXX
                      firstname: Annette
                      id: 12
                      middlenames: ''
                      salutation: Mrs
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0000-0849
                    - addresses:
                      - addressLine1: Home
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 3174
                        postcode: N4 4DL
                        town: Home
                        type: Primary
                      companyName: ''
                      dob: '2000-12-15'
                      email: ''
                      firstname: Jess
                      id: 3453
                      middlenames: ''
                      salutation: ''
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0015-0610
                    cancellationDate: ''
                    caseAttorneyJointly: false
                    caseAttorneyJointlyAndJointlyAndSeverally: true
                    caseAttorneyJointlyAndSeverally: false
                    caseAttorneySingular: false
                    caseSubtype: hw
                    certificateProviders:
                    - addresses:
                      - addressLine1: 50 Fordham Rd
                        addressLine2: HADFIELD
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 11
                        postcode: SK14 0RH
                        town: ''
                        type: Primary
                      dob: ''
                      email: ''
                      firstname: Danielle
                      id: 11
                      middlenames: ''
                      salutation: Miss
                      surname: Hart
                      uId: 7000-0000-0831
                    dispatchDate: '2021-04-26'
                    donor:
                      addresses:
                      - addressLine1: 81 Front Street
                        addressLine2: LACEBY
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 7
                        postcode: DN37 5SH
                        town: ''
                        type: Primary
                      companyName: ''
                      dob: '1948-11-01'
                      email: RachelSanderson@opgtest.com
                      firstname: Rachel
                      id: 7
                      linked:
                      - id: 7
                        uId: 7000-0000-0799
                      middlenames: Emma
                      salutation: Mr
                      surname: Sanderson
                      uId: 7000-0000-0799
                    id: 2
                    invalidDate: ''
                    lifeSustainingTreatment: Option A
                    lpaDonorSignatureDate: '2018-12-12'
                    lpaIsCleansed: false
                    onlineLpaId: A33718377316
                    receiptDate: '2014-09-26'
                    registrationDate: '2021-04-26'
                    rejectedDate: ''
                    replacementAttorneys: []
                    status: Registered
                    statusDate: ''
                    trustCorporations: []
                    uId: 7000-0000-0047
                    withdrawnDate: ''
                meris2000000:
                  value:
                  - applicationHasGuidance: false
                    applicationHasRestrictions: false
                    applicationType: Classic
                    attorneyActDecisions: ''
                    attorneys:
                    - addresses:
                      - addressLine1: 9 High Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 9
                        postcode: B89 7JK
                        town: Leafland
                        type: Primary
                      companyName: null
                      dob: '1990-05-04'
                      email: ''
                      firstname: Jean
                      id: 9
                      middlenames: ''
                      salutation: ''
                      surname: Sanderson
                      systemStatus: true
                      uId: 7000-0000-0815
                    - addresses:
                      - addressLine1: 7 The Low Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 12
                        postcode: WR1 1EK
                        town: Worcester
                        type: Primary
                      companyName: ''
                      dob: '1975-10-05'
                      email: XXXXX
                      firstname: Annette
                      id: 12
                      middlenames: ''
                      salutation: Mrs
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0000-0849
                    - addresses:
                      - addressLine1: Home
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 3174
                        postcode: N4 4DL
                        town: Home
                        type: Primary
                      companyName: ''
                      dob: '2000-12-15'
                      email: ''
                      firstname: Jess
                      id: 3453
                      middlenames: ''
                      salutation: ''
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0015-0610
                    cancellationDate: ''
                    caseAttorneyJointly: false
                    caseAttorneyJointlyAndJointlyAndSeverally: true
                    caseAttorneyJointlyAndSeverally: false
                    caseAttorneySingular: false
                    caseSubtype: hw
                    certificateProviders:
                    - addresses:
                      - addressLine1: 50 Fordham Rd
                        addressLine2: HADFIELD
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 11
                        postcode: SK14 0RH
                        town: ''
                        type: Primary
                      dob: ''
                      email: ''
                      firstname: Danielle
                      id: 11
                      middlenames: ''
                      salutation: Miss
                      surname: Hart
                      uId: 7000-0000-0831
                    dispatchDate: '2021-04-26'
                    donor:
                      addresses:
                      - addressLine1: 81 Front Street
                        addressLine2: LACEBY
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 7
                        postcode: DN37 5SH
                        town: ''
                        type: Primary
                      companyName: ''
                      dob: '1948-11-01'
                      email: RachelSanderson@opgtest.com
                      firstname: Rachel
                      id: 7
                      linked:
                      - id: 7
                        uId: 7000-0000-0799
                      middlenames: Emma
                      salutation: Mr
                      surname: Sanderson
                      uId: 7000-0000-0799
                    id: 2
                    invalidDate: ''
                    lifeSustainingTreatment: Option A
                    lpaDonorSignatureDate: '2018-12-12'
                    lpaIsCleansed: false
                    onlineLpaId: A33718377316
                    receiptDate: '2014-09-26'
                    registrationDate: '2021-04-26'
                    rejectedDate: ''
                    replacementAttorneys: []
                    status: Registered
                    statusDate: ''
                    trustCorporations: []
                    uId: 7000-0000-0000
                    withdrawnDate: ''
                  - applicationHasGuidance: false
                    applicationHasRestrictions: false
                    applicationType: Classic
                    attorneyActDecisions: ''
                    attorneys:
                    - addresses:
                      - addressLine1: 9 High Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 9
                        postcode: B89 7JK
                        town: Leafland
                        type: Primary
                      companyName: null
                      dob: '1990-05-04'
                      email: ''
                      firstname: Jean
                      id: 9
                      middlenames: ''
                      salutation: ''
                      surname: Sanderson
                      systemStatus: true
                      uId: 7000-0000-0815
                    - addresses:
                      - addressLine1: 7 The Low Street
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 12
                        postcode: WR1 1EK
                        town: Worcester
                        type: Primary
                      companyName: ''
                      dob: '1975-10-05'
                      email: XXXXX
                      firstname: Annette
                      id: 12
                      middlenames: ''
                      salutation: Mrs
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0000-0849
                    - addresses:
                      - addressLine1: Home
                        addressLine2: ''
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 3174
                        postcode: N4 4DL
                        town: Home
                        type: Primary
                      companyName: ''
                      dob: '2000-12-15'
                      email: ''
                      firstname: Jess
                      id: 3453
                      middlenames: ''
                      salutation: ''
                      surname: Doe
                      systemStatus: true
                      uId: 7000-0015-0610
                    cancellationDate: ''
                    caseAttorneyJointly: false
                    caseAttorneyJointlyAndJointlyAndSeverally: true
                    caseAttorneyJointlyAndSeverally: false
                    caseAttorneySingular: false
                    caseSubtype: hw
                    certificateProviders:
                    - addresses:
                      - addressLine1: 50 Fordham Rd
                        addressLine2: HADFIELD
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 11
                        postcode: SK14 0RH
                        town: ''
                        type: Primary
                      dob: ''
                      email: ''
                      firstname: Danielle
                      id: 11
                      middlenames: ''
                      salutation: Miss
                      surname: Hart
                      uId: 7000-0000-0831
                    dispatchDate: '2021-04-26'
                    donor:
                      addresses:
                      - addressLine1: 81 Front Street
                        addressLine2: LACEBY
                        addressLine3: ''
                        country: ''
                        county: ''
                        id: 7
                        postcode: DN37 5SH
                        town: ''
                        type: Primary
                      companyName: ''
                      dob: '1948-11-01'
                      email: RachelSanderson@opgtest.com
                      firstname: Rachel
                      id: 7
                      linked:
                      - id: 7
                        uId: 7000-0000-0799
                      middlenames: Emma
                      salutation: Mr
                      surname: Sanderson
                      uId: 7000-0000-0799
                    id: 2
                    invalidDate: ''
                    lifeSustainingTreatment: Option A
                    lpaDonorSignatureDate: '2018-12-12'
                    lpaIsCleansed: false
                    onlineLpaId: A33718377316
                    receiptDate: '2014-09-26'
                    registrationDate: '2021-04-26'
                    rejectedDate: ''
                    replacementAttorneys: []
                    status: Registered
                    statusDate: ''
                    trustCorporations: []
                    uId: 7000-0000-0047
                    withdrawnDate: ''
              schema:
                $ref: '#/components/schemas/LpaCollection'
          description: LPA details returned for the requested ID
          headers:
            Age:
              description: 'The time elapsed, measured in seconds, since the returned
                response body was retrieved from Sirius.

                Under normal circumstances this will be zero (0), indicating the response
                represents the current ''live'' state within Sirius.

                In the case that the Gateway was unable to retrieve an up to date
                response from Sirius, it will make best efforts to return a cached
                version.

                It''s up to the consumer of the API to determine if they wish to use
                a response based on its age.

                '
              schema:
                type: integer
        '400':
          description: Bad request
        '403':
          description: Authentication failed
        '404':
          description: An LPA with the passed ID Not Found
        '429':
          description: API Gateway throttling limit exceeded
        '500':
          description: Unhandeled internal exception within OPG Gateway
        '502':
          description: The Sirius data provider returned an exception
        '504':
          description: The Sirius data provider timed out
      security:
      - sigv4: []
      tags:
      - use-a-lpa
      x-amazon-apigateway-integration:
        contentHandling: CONVERT_TO_TEXT
        httpMethod: POST
        passthroughBehavior: when_no_match
        responses:
          default:
            statusCode: '200'
        type: aws_proxy
        uri: arn:aws:apigateway:${region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${region}:${account_id}:function:$${stageVariables.flask_app_name}/invocations
      x-amazon-apigateway-request-validator: all
servers:
- description: we use the path only so we can use in different contexts
  url: /v1
x-amazon-apigateway-gateway-responses:
  ACCESS_DENIED:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-FORBIDDEN",
        "title":$context.error.messageString, "detail":"Forbidden - The current user
        is forbidden from accessing this data (in this way)", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  API_CONFIGURATION_ERROR:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-API_CONFIGURATION_ERROR",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  AUTHORIZER_CONFIGURATION_ERROR:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-AUTHORIZER_CONFIGURATION_ERROR",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  AUTHORIZER_FAILURE:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-AUTHORIZER_FAILURE",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  BAD_REQUEST_BODY:
    responseTemplates:
      application/json: '{"errors": [{ "id": "$context.requestId", "code": "OPGDATA-API-INVALIDREQUEST",
        "title":$context.error.messageString, "detail":"$context.error.validationErrorString",
        "meta": {"x-ray": "$context.xrayTraceId"} }]}'
  BAD_REQUEST_PARAMETERS:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-BAD_REQUEST_PARAMETERS",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  DEFAULT_4XX:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-INVALIDREQUEST",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  DEFAULT_5XX:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-SERVERERROR",
        "title":$context.error.messageString, "detail":"Something unexpected happened
        internally", "meta": {"x-ray": "$context.xrayTraceId"} }}'
  EXPIRED_TOKEN:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-EXPIRED_TOKEN",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  INTEGRATION_FAILURE:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-INTEGRATION_FAILURE",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  INTEGRATION_TIMEOUT:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-INTEGRATION_TIMEOUT",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  INVALID_API_KEY:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-INVALID_API_KEY",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  INVALID_SIGNATURE:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-INVALID_SIGNATURE",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  MISSING_AUTHENTICATION_TOKEN:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-MISSING_AUTHENTICATION_TOKEN",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  QUOTA_EXCEEDED:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-QUOTA_EXCEEDED",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  REQUEST_TOO_LARGE:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-FILESIZELIMIT",
        "title":$context.error.messageString, "detail":"Payload too large, try and
        upload in smaller chunks", "meta": {"x-ray": "$context.xrayTraceId"} }}'
  RESOURCE_NOT_FOUND:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-NOTFOUND",
        "title":$context.error.messageString, "detail":"That URL is not a valid route,
        or the item resource does not exist", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  THROTTLED:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-THROTTLED",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
  UNAUTHORIZED:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-UNAUTHORISED",
        "title":$context.error.messageString, "detail":"Unauthorised (no current user
        and there should be)", "meta": {"x-ray": "$context.xrayTraceId"} }}'
  UNSUPPORTED_MEDIA_TYPE:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-MEDIA",
        "title":$context.error.messageString, "detail":"Unsupported media type for
        this endpoint", "meta": {"x-ray": "$context.xrayTraceId"} }}'
  WAF_FILTERED:
    responseTemplates:
      application/json: '{"errors": { "id": "$context.requestId", "code": "OPGDATA-API-WAF_FILTERED",
        "title":$context.error.messageString, "detail": "", "meta": {"x-ray": "$context.xrayTraceId"}
        }}'
x-amazon-apigateway-policy:
  Statement:
  - Action: execute-api:Invoke
    Effect: Allow
    Principal:
      AWS: []
    Resource:
    - arn:aws:execute-api:eu-west-1:${account_id}:*/*/*/*
  Version: '2012-10-17'
x-amazon-apigateway-request-validators:
  all:
    validateRequestBody: true
    validateRequestParameters: true
