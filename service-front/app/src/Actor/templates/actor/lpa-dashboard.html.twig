{% extends '@actor/layout.html.twig' %}

{% block html_title %}Your lasting powers of attorney - {{ parent() }} {% endblock %}

{% block content %}
<div class="govuk-width-container">
    {{ include('@actor/partials/new-use-service.html.twig') }}

    {{ include('@partials/account-bar.html.twig') }}

    <main class="govuk-main-wrapper" id="main-content" role="main">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-full">
                <h1 class="govuk-heading-xl">Your lasting powers of attorney</h1>
            </div>
        </div>

        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <p class="govuk-body-l">Any lasting power of attorney (LPA) you add to your account will appear on this page.</p>
                <details class="govuk-details" data-module="govuk-details" {% if active_access_code_count === 0 %} open {% endif %} >
                    <summary class="govuk-details__summary">
                        <span class="govuk-details__summary-text">
                          What can I do with my <abbr title="lasting powers of attorney">LPAs</abbr>?
                        </span>
                    </summary>
                    <div class="govuk-details__text">
                        <p>From this page you can:</p>
                        <ul class="govuk-list govuk-list--bullet">
                            <li>give organisations access to an online summary of this <abbr title="lasting power of attorney">LPA</abbr> by making a secure access code</li>
                            <li>keep track of which organisations have been given online access to the <abbr title="lasting power of attorney">LPA</abbr></li>
                            <li>view the <abbr title="lasting power of attorney">LPA</abbr> summary</li>
                        </ul>
                    </div>
                </details>

                <a href="{{ path('lpa.add') }}" draggable="false" class="govuk-button">
                    Add another LPA
                </a>

            </div>
        </div>

        <div class="govuk-grid-row">
            <div class="govuk-grid-column-full">

                {% for lpaData in lpas %}
                    {% set lpa = lpaData['lpa'] %}
                    {% set actorToken = lpaData['user-lpa-actor-token'] %}
                    {% set actorActive = lpaData['actorActive'] %}
                    {% set activeCodeCount = lpaData['activeCodeCount'] %}
                    {% set caseSubtype = lpa.caseSubtype == 'pfa' ? 'Property and finance' : 'Health and welfare' %}
                    {% set applicationHasRestrictions = lpa.applicationHasRestrictions %}
                    {% set applicationHasGuidance = lpa.applicationHasGuidance %}
                    {{ include('@actor/partials/lpa-details.html.twig') }}
                {% endfor %}

            </div>
        </div>

    </main>
</div>
{% endblock %}
